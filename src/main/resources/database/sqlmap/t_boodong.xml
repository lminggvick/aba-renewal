<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD MAPPER 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="model.TemporaryAbaOffer">

    <!-- Mapper -->
    <resultMap id="abaOffer" type="TemporaryAbaOffer">
        <id property="id" column="l_number" />

        <result property="title" column="title" />
        <result property="si" column="area2" />
        <result property="dou" column="area1" />
        <result property="dongArea" column="addr" />
        <result property="jibunAddr" column="addr2" />
        <result property="roadName" column="juso1" />
        <result property="roadNum" column="juso2" />

        <result property="tel" column="m_phone" /> <!-- 연락처 -->
        <result property="description" column="remark" /> <!-- 사용자 메모 (절충가능 / 기타 추가설명) -->
        <result property="adminMemo" column="remark_memo" /> <!-- 관리자 메모 -->
        <result property="building" column="jibun_addr_etc" /> <!-- 건물명 -->
        <result property="pyeong" column="pyeong" /> <!-- 평수 -->

        <result property="statusCode" column="etc2" /> <!-- ( 0: 진행 / 1: 계약완료 / 2: 숨김 ) -->
        <result property="offerTypeCode" column="gubun" />
        <result property="dealTypeCode" column="etc1" />

        <result property="heatingType" column="hot" /> <!-- 난방유형 -->
        <result property="hitMethod" column="input4" /> <!-- 난방방식 -->

        <result property="checkDate" column="date" typeHandler="org.apache.ibatis.type.SqlTimestampTypeHandler"/> <!-- 확인일자 -->

        <result property="near" column="input1" /> <!-- 부근위치 -->

        <result property="enter" column="extra4" /> <!-- 입구번호 -->
        <result property="addedInfo" column="extra6" /> <!-- 부가적인 정보... -->
        <result property="aptTerm" column="extra7" /> <!-- 아파트일 때 세입자 여부 ㅡㅡ (비어있음 / 주인거주중 / 세입자있음 ) -->
        <result property="completionYear" column="extra8" /> <!-- 준공년도 -->
        <result property="expand" column="extra9" /> <!-- 확장여부 : 원룸일때는 이필드가 비어있다 -->
        <result property="term" column="extra10" /> <!-- 즉시입주일 또는 단기여부 -->
        <result property="tenant" column="extra11" /> <!-- 세입자 -->
        <result property="dong" column="dong" /> <!-- 동 -->
        <result property="ho" column="extra12" /> <!-- 호 -->
        <result property="room" column="extra13" /> <!-- 호실암호 -->
        <result property="pet" column="extra14" />
        <result property="parking" column="extra15" />

        <result property="latitude" column="x_point" />
        <result property="longitude" column="y_point" />

        <result property="options" column="bd_option1" />
        <result property="managementCategories" column="bd_option2" />

        <result property="salePrice" column="price1" /> <!-- 매매가 -->
        <result property="deposit" column="price2" /> <!-- 보증금 -->
        <result property="monthly" column="price3" /> <!-- 월세 또는 월 임대료 -->
        <result property="manageOrProfit" column="price5" /> <!-- 관리비 또는 수익 -->

        <collection property="images" column="l_number" javaType="java.lang.String" select="selectImagesOffer" />
    </resultMap>

    <select id="selectAbaOffers" resultMap="abaOffer">
        SELECT * FROM t_boodong WHERE del_yn = 'N' AND gubun != (10 OR 11 OR 54 OR 55 OR 56 OR 59 OR 60) AND l_number = 1;
    </select>

    <select id="selectImagesOffer" resultType="java.lang.String">
        SELECT CONCAT(
                       img1,
                       IF(img2 != '', CONCAT(",", img2), ''),
                       IF(img3 != '', CONCAT(",", img3), ''),
                       IF(img4 != '', CONCAT(",", img4), ''),
                       IF(img5 != '', CONCAT(",", img5), ''),
                       IF(img6 != '', CONCAT(",", img6), ''),
                       IF(img7 != '', CONCAT(",", img7), ''),
                       IF(img8 != '', CONCAT(",", img8), ''),
                       IF(img9 != '', CONCAT(",", img9), ''),
                       IF(img10 != '', CONCAT(",", img10), ''),
                       IF(img11 != '', CONCAT(",", img11), ''),
                       IF(img12 != '', CONCAT(",", img12), '')
               ) AS "images"
        FROM t_boodong WHERE l_number = #{id}
    </select>
</mapper>
